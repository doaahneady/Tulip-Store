<%- include('./includes/head') %>
<!-- sign up form -->
<div class="container d-flex align-items-center">
  <div class="card-signup shadow-sm">
    <div class="card-body p-4">
      <h3 class="card-title text-center mb-4">Business Account</h3>

      <form
        id="signupForm"
        class="row g-3"
        novalidate
        onsubmit="return performSignup(event)"
      >
        <div class="front" id="front">
          <div
            class="d-flex justify-content-center button-front mb-3"
            id="button_signIn"
          >
            <button type="button" class="btn btn-lg w-100">Sign In</button>
          </div>

          <div
            class="d-flex justify-content-center button-front mb-3"
            id="button_creat"
          >
            <button type="button" class="btn btn-lg w-100">
              Creat Business Account
            </button>
          </div>

          <div
            class="d-flex justify-content-center button-front mb-3"
            id="button_creat"
          >
            <button
              type="button"
              class="btn btn-lg w-100"
              onclick="history.back()"
            >
              back to main page
            </button>
          </div>
        </div>
        <!-- sign in form -->
        <div class="signIn_form" id="business_signIn">
          <!-- business name -->
          <div class="col-12 mb-3">
            <input
              type="text"
              class="form-control"
              id="businessName"
              placeholder="business name"
            />
            <div class="invalid-feedback">Please enter your business name.</div>
          </div>
          <!-- password -->
          <div class="col-12 mb-3">
            <input
              type="password"
              class="form-control"
              id="businessPassword"
              placeholder="Password"
            />
            <div class="invalid-feedback">
              Please enter a password (min 8 characters).
            </div>
          </div>
          <p class="mb-3">
            <a href="" class="forget-link" id="forgetLink"> forget password?</a>
          </p>
          <div class="col-12 d-flex justify-content-center px-0 mb-3">
            <button type="click" class="btn btn-lg w-100" id="register">
              Sign In
            </button>
          </div>
          <div class="col-12 d-flex justify-content-center px-0 mb-3">
            <button class="btn btn-back btn-lg w-100" onclick="history.back()">
              back
            </button>
          </div>
        </div>
        <!-- sign up form -->
        <div class="signUp_form" id="business_signUp">
          <!-- business name -->
          <div class="col-12 mb-3">
            <input
              type="text"
              class="form-control"
              id="B_Name"
              placeholder="business name"
            />
            <div class="invalid-feedback">Please enter your business name.</div>
          </div>
          <!-- email -->
          <div class="col-12 mb-3">
            <input
              type="email"
              class="form-control"
              id="B_Email"
              placeholder="E-mail"
            />
            <div class="invalid-feedback">
              Please enter a valid email address.
            </div>
          </div>

          <!-- phone number -->
          <div class="col-12 mb-4">
            <div class="d-flex">
              <select
                id="flag"
                class="form-select"
                style="width: 130px; border-radius: 5px 0 0 5px"
              >
                <option hidden selected value="">Select</option>
                <option value="+963">ðŸ‡¸ðŸ‡¾ +963</option>
                <option value="+961">ðŸ‡±ðŸ‡§ +961</option>
                <option value="+20">ðŸ‡ªðŸ‡¬ +20</option>
                <option value="+966">ðŸ‡¸ðŸ‡¦ +966</option>
                <option value="+962">ðŸ‡¯ðŸ‡´ +962</option>
              </select>

              <input
                type="text"
                id="inputphone"
                class="form-control"
                placeholder="Phone number"
                style="border-radius: 0 5px 5px 0"
                disabled
              />
            </div>

            <div class="invalid-feedback" id="message_num1">
              - please select your country & phone number.
            </div>
            <div class="invalid-feedback" id="message_num2">
              - The key was selected(country) but phone number was not written
            </div>
            <div class="invalid-feedback" id="message_num3">
              - phone number was wrong try again.
            </div>
          </div>

          <!-- password -->
          <div class="col-12 mb-3">
            <input
              type="password"
              class="form-control"
              id="inputPassword"
              placeholder="Password"
            />
            <div class="invalid-feedback" id="pass_1">
              - The password must contain at least 8 characters
            </div>
            <div class="invalid-feedback" id="pass_2">
              - it must contain the letters A-Z and a-z
            </div>
            <div class="invalid-feedback" id="pass_3">
              - it must contain numbers
            </div>
          </div>
          <!-- Policy -->
          <div class="form-check mb-5">
            <input
              class="form-check-input"
              type="checkbox"
              value=""
              checked
              id="policyChecked"
              disabled
            />
            <label class="form-check-label" for="checkDefault">
              I agree to the <a href="/ReturnPolicy">ReturnPolicy</a> &
              <a href="/ReturnPolicy">Shipping Policy</a>
            </label>
          </div>

          <div class="col-12 d-flex justify-content-center px-0 mb-3"></div>
          <!-- submit sign up -->
          <div class="col-12 d-flex justify-content-center px-0 mb-3">
            <button type="button" class="btn btn-lg w-100" id="creat">
              Next
            </button>
          </div>
          <!-- back -->
          <div class="col-12 d-flex justify-content-center px-0 mb-3">
            <button class="btn btn-back btn-lg w-100" onclick="history.back()">
              back
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<style>
  @import url(https://db.onlinewebfonts.com/c/ba155473d72fb574bd945b20f4598560?family=Montserrat-Alt1+SemBd);
  @import url(https://db.onlinewebfonts.com/c/29295d2928c6bd76a76c9e789982bc85?family=Montserrat-Alt1+Med);

  @font-face {
    font-family: "Montserrat-Alt1 SemBd";
    src: url("https://db.onlinewebfonts.com/t/ba155473d72fb574bd945b20f4598560.eot");
    src: url("https://db.onlinewebfonts.com/t/ba155473d72fb574bd945b20f4598560.eot?#iefix")
        format("embedded-opentype"),
      url("https://db.onlinewebfonts.com/t/ba155473d72fb574bd945b20f4598560.woff2")
        format("woff2"),
      url("https://db.onlinewebfonts.com/t/ba155473d72fb574bd945b20f4598560.woff")
        format("woff"),
      url("https://db.onlinewebfonts.com/t/ba155473d72fb574bd945b20f4598560.ttf")
        format("truetype"),
      url("https://db.onlinewebfonts.com/t/ba155473d72fb574bd945b20f4598560.svg#Montserrat-Alt1 SemBd")
        format("svg");
  }

  @font-face {
    font-family: "Montserrat-Alt";
    src: url("https://db.onlinewebfonts.com/t/29295d2928c6bd76a76c9e789982bc85.eot");
    src: url("https://db.onlinewebfonts.com/t/29295d2928c6bd76a76c9e789982bc85.eot?#iefix")
        format("embedded-opentype"),
      url("https://db.onlinewebfonts.com/t/29295d2928c6bd76a76c9e789982bc85.woff2")
        format("woff2"),
      url("https://db.onlinewebfonts.com/t/29295d2928c6bd76a76c9e789982bc85.woff")
        format("woff"),
      url("https://db.onlinewebfonts.com/t/29295d2928c6bd76a76c9e789982bc85.ttf")
        format("truetype"),
      url("https://db.onlinewebfonts.com/t/29295d2928c6bd76a76c9e789982bc85.svg#Montserrat-Alt1 Med")
        format("svg");
  }
  body {
    background-image: url("images/business.jpg");
    background-repeat: none;
    background-size: cover;
    font-family: "Montserrat-Alt1 SemBd";
  }
  placeholder {
    font-family: "Montserrat-Alt1";
  }
  .container {
    min-height: 100vh;
    padding: 40px;
    width: 600px;
  }
  .signIn_form {
    display: none;
  }
  .signUp_form {
    display: none;
  }
  .front {
    display: inline;
  }
  .card-signup {
    border-radius: 40px;
    width: 100%;
    height: auto;

    background-color: #ffffff17;
    backdrop-filter: blur(20px);
    color: #e7c8b3;
  }
  form.button-front {
    border: none;
    padding: 30px;
    gap: 30px;
  }

  h3 {
    font-weight: 700;
    font-size: 40px;
  }

  .btn {
    background-color: #e7c8b3;
    /* box-shadow: inset 2px 2px 4px rgb(255, 255, 255), inset -2px -2px 4px #0d464c; */
    color: #0d464c;
    font-weight: bold;
    border: none;
  }
  .button-sign-up {
    margin-left: 450px;
  }
  .btn:hover,
  .btn::after {
    color: #e7c8b3;
    background-color: #0d464c;
    border: none;
  }

  .form-select {
    border-radius: 10px;
    border: none;
    font-weight: 500;
    background-color: #ffffff;
    color: #0d464c;
  }

  /* toast (bottom-right) */
  .toast-fixed {
    position: fixed;
    bottom: 1rem;
    right: 1rem;
    z-index: 1100;
  }

  /* validate */
  /* error message hidden by default */
  .error-message {
    color: #dc3545;
    font-size: 0.85rem;
    display: none;
    margin-top: 0.25rem;
  }
  .message-error {
    color: red;
    display: none;
  }
  /* show when invalid */
  .invalid .error-message {
    display: block;
  }

  /* outline for invalid/valid */
  .is-invalid {
    border-color: #dc3545 !important;
    box-shadow: 0 0 0 0.1rem rgba(220, 53, 69, 0.15);
  }
  .is-valid {
    border-color: #28a745 !important;
    box-shadow: 0 0 0 0.1rem rgba(40, 167, 69, 0.12);
  }

  /* validation icon placed to the right of inputs */
  .validation-wrapper {
    position: relative;
    display: flex;
    align-items: center;
  }
  .validation-icon {
    position: absolute;
    right: 10px;
    pointer-events: none;
    font-size: 1.1rem;
    top: 50%;
    transform: translateY(-50%);
    display: none;
  }
  .validation-icon.valid {
    color: #28a745;
    display: inline;
  }
  .validation-icon.invalid {
    color: #dc3545;
    display: inline;
  }

  /* for fieldset groups (radios) */
  .fieldset-invalid {
    border: 1px solid rgba(220, 53, 69, 0.2);
    padding: 0.6rem;
    border-radius: 0.25rem;
  }
  .fieldset-valid {
    border: 1px solid rgba(40, 167, 69, 0.15);
    padding: 0.6rem;
    border-radius: 0.25rem;
  }

  /* disable submit look */
  button[disabled] {
    opacity: 0.6;
    pointer-events: none;
  }
</style>

<script>
  const main_front = document.getElementById("front");
  const signIn_form = document.getElementById("business_signIn");
  const signUp_form = document.getElementById("business_signUp");

  const signIn_button = document.getElementById("button_signIn");
  const signUp_button = document.getElementById("button_creat");

  signIn_button.addEventListener("click", function () {
    main_front.style.display = "none";
    signIn_form.style.display = "inline";
    signUp_form.style.display = "none";
  });

  signUp_button.addEventListener("click", function () {
    main_front.style.display = "none";
    signUp_form.style.display = "inline";
    signIn_form.style.display = "none";
  });
  // sign in
  const register = document.getElementById("register");
  const businessName = document.getElementById("businessName");
  const businessPassword = document.getElementById("businessPassword");

  // sign in validation
  // *****************************************************************************
  // sign in
  register.addEventListener("click", async function (event) {
    event.preventDefault();

    // remove previous state
    businessName.classList.remove("is-valid", "is-invalid");
    businessPassword.classList.remove("is-valid", "is-invalid");

    const email = businessName.value.trim();
    const password = businessPassword.value.trim();
    const variteEmail = "d@gmail.com";
    const varitePass = "ddffggkk";
    let registerError = false;
    // validate email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (email === "" || !emailRegex.test(email)) {
      businessName.classList.add("is-invalid");

      registerError = true;
    } else if (email === variteEmail) {
      businessName.classList.add("is-valid");
    }

    // validate password
    if (password === "ddffggkk") {
      businessPassword.classList.add("is-valid");
    } else {
      businessPassword.classList.add("is-invalid");
      registerError = true;
    }

    if (registerError) return;
  });

  //  sign up
  const B_Name = document.getElementById("B_Name");
  const B_Email = document.getElementById("B_Email");
  const inputphone = document.getElementById("inputphone");
  const inputPassword = document.getElementById("inputPassword");

  const creat = document.getElementById("creat");

  // sign up validation
  creat.addEventListener("click", function () {
    const inputphone = document.getElementById("inputphone");
    const Password = document.getElementById("Password");
    const policyChecked = document.getElementById("policyChecked");
    const flag = document.getElementById("flag");

    let businessError = false;
    // validate full name
    B_Name.classList.remove("is-valid", "is-invalid");
    const name = B_Name.value;
    if (name === "") {
      B_Name.classList.add("is-invalid");
      businessError = true;
    } else {
      B_Name.classList.add("is-valid");
    }

    // validate email
    B_Email.classList.remove("is-valid", "is-invalid");
    const emailAddress = B_Email.value;
    if (/^[\w.-]+@gmail\.com$/.test(emailAddress)) {
      B_Email.classList.add("is-valid");
    } else {
      B_Email.classList.add("is-invalid");
      businessError = true;
    }

    //  phone number
    flag.addEventListener("change", validatePhone);

    function validatePhone() {
      const countryCode = flag.value.trim();
      const phone = inputphone.value.trim();

      flag.classList.remove("is-valid", "is-invalid");
      inputphone.classList.remove("is-valid", "is-invalid");

      if (countryCode === "" && phone === "") {
        message_num1.style.display = "block";
        flag.classList.add("is-invalid");
        pass_1.classList.add("is-invalid");
        businessError = true;
        return;
      }

      if (countryCode !== "") {
        if (!phone.startsWith(countryCode)) {
          inputphone.disabled = false;
          inputphone.value = countryCode + " ";
        }
        flag.classList.add("is-valid");
      }

      const regex = /^[+0-9\s]+$/;
      if (!regex.test(phone) && !inputphone.disabled) {
        alert("test");

        inputphone.classList.add("is-invalid");
        businessError = true;
        return;
      }

      if (countryCode !== "" && phone.startsWith(countryCode)) {
        flag.classList.add("is-valid");
        inputphone.classList.add("is-valid");
      }
    }
    // validate phone
    validatePhone();
    const pass_1 = document.getElementById("pass_1");
    const pass_2 = document.getElementById("pass_2");
    const pass_3 = document.getElementById("pass_3");
    // validate password
    Password.classList.remove("is-valid", "is-invalid");
    pass_1.classList.remove("is-valid", "is-invalid");
    pass_2.classList.remove("is-valid", "is-invalid");
    pass_3.classList.remove("is-valid", "is-invalid");
    const pass = Password.value;
    if (pass.length <= 8 || !/[A-Z]/.test(pass) || !/[0-9]/.test(pass)) {
      Password.classList.add("is-invalid");
      if (pass.length <= 8) {
        Password.classList.add("is-invalid");

        businessError = true;
      } else {
        pass_1.classList.add("is-valid");
      }
      if (!/[A-Z]/.test(pass)) {
        pass_2.classList.add("is-invalid");
      } else {
        pass_2.classList.add("is-valid");
      }
      if (!/[0-9]/.test(pass)) {
        pass_3.classList.add("is-invalid");
      } else {
        pass_3.classList.add("is-valid");
      }
    } else {
      Password.classList.add("is-valid");
    }

    if (businessError) {
      return;
    } else {
      alert("Welcome");
      window.location.href = "/";
    }
  });
</script>
